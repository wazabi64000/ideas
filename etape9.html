<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Étape 9 – Affichage dynamique | Boîte à Idées</title>
<link rel="stylesheet" href="public/css/styles.css">
</head>
<body>
<header>
<nav class="navbar">
<div class="nav-logo"><a href="index.html">Boîte à Idées</a></div>
<button class="nav-toggle" id="nav-toggle" aria-label="Menu">☰</button>
<ul class="nav-links" id="nav-links">
<li><a href="index.html">Introduction</a></li>
<li><a href="etape1.html">Étape 1</a></li>
<li><a href="etape2.html">Étape 2</a></li>
<li><a href="etape3.html">Étape 3</a></li>
<li><a href="etape4.html">Étape 4</a></li>
<li><a href="etape5.html">Étape 5</a></li>
<li><a href="etape6.html">Étape 6</a></li>
<li><a href="etape7.html">Étape 7</a></li>
<li><a href="etape8.html">Étape 8</a></li>
<li><a href="etape9.html">Étape 9</a></li>
<li><a href="etape10.html">Étape 10</a></li>
<li><a href="etape11.html">Étape 11</a></li>
<li><a href="recap.html">Récapitulatif</a></li>
</ul>
</nav>
</header>

<main>
<section id="introduction">
<h1>Étape 9 – Affichage dynamique et mise à jour</h1>
<p>
Nous allons afficher toutes les idées existantes côté client et mettre à jour la liste après création.
</p>
</section>

<section id="theorie">
<pre><code>
// public/js/script.js
const listeIdees = document.getElementById("listeIdees");

async function chargerIdees() {
  const res = await fetch("/api/idees", {
    headers: { Authorization: "Bearer " + localStorage.getItem("token") }
  });
  const data = await res.json();
  listeIdees.innerHTML = data.map(idee => `
    <div class="idee">
      <h3>${idee.titre}</h3>
      <p>${idee.description}</p>
      ${idee.image ? `<img src="/uploads/${idee.image}" alt="Image de l'idée">` : ""}
    </div>
  `).join("");
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData(form);
  await fetch("/api/idees", { method: "POST", body: formData, headers: { Authorization: "Bearer " + localStorage.getItem("token") }});
  form.reset();
  chargerIdees();
});

window.onload = chargerIdees;
</code></pre>
</section>

<section id="recap">
<ul>
<li>Liste dynamique des idées côté client</li>
<li>Actualisation après ajout</li>
<li>Interaction complète avec l’API</li>
</ul>
</section>

<section id="etape-suivante">
<p>Étape 10 : Styles et accessibilité mobile-first.</p>
</section>
</main>

<footer>
<p>Projet Boîte à Idées – Étape 9</p>
</footer>
<script src="public/js/script.js"></script>
</body>
</html>
